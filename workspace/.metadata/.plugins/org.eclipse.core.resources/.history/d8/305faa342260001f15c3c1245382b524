<!DOCTYPE html>
<html lang="kr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XMLHttpRequest</title>

    <link rel="stylesheet" href="../css/public.css">
    <script src="../js/jquery-3.7.1.js"></script>

    <style>
        
    </style>

    <script>

        const xhr = new XMLHttpRequest();
        
        
        $(()=>{
            $('#asynb').on('click', ()=>{

                // name속성을 이용
                // vname = document.ff1.name.value;
                // vtel = document.ff1.tel.value;
                // console.log(vname, vtel);
                
                // 입력한 값을 가져온다. id 속성을 이용
                vname = $('#name').val().trim(); // id가 name인것의 값을 앞뒤 공백 지우고 가져오기
                vtel = $('#tel').val().trim();

                // 서버로 전송 - 요청
                xhr.open('get', 'test1.jsp?name='+vname+'&tel='+vtel, true); // jsp?name= 뒤에 공백 있으면 안됨 $tel=뒤에도 있으면 안됨
                xhr.send();
                
                // 응답
                // xhr.onload = function(){
                // onreadystatechange로 readystate가 변하는 것을 확인할 수 있음
                xhr.onreadystatechange = function(){ // onreadystate가 method로 쓰일때는 전부 소문자
                	// alert(this.readyState); // 숫자 뜨는거 확인하기
                	if(this.readyState==4 && this.status==200){
                		res = this.responseText;
                		
                		$('#result1').html(res);
                	}
                }
            })
        })
    </script>

</head>

<body>

    <div class="box">
        <h1>
        	1. 비동기 XMLHttpRequest<br>get방식
        </h1>

        <form id="ff1" name="ff1" action="test1.jsp" method="get">
            이름 <input type="text" name="name" id="name"><br>
            전호번호 <input type="text" name="tel" id="tel"><br>
            <input type="submit" value="동기방식"> <!-- submit은 하나의 form 안에 1개만 가능 -->
            <input type="button" value="비동기방식" id="asynb">
        </form><br>

        <div id="result1"></div>
    </div>

    <div class="box">
        <h1>
        	1. 비동기 XMLHttpRequest<br>post방식
        </h1>

        <form id="ff1" name="ff1" action="test1.jsp" method="post">
            이름 <input type="text" name="name" id="name"><br>
            전호번호 <input type="text" name="tel" id="tel"><br>
            <input type="submit" value="동기방식"> <!-- submit은 하나의 form 안에 1개만 가능 -->
            <input type="button" value="비동기방식" id="asynpost">
        </form><br>

        <div id="result2"></div>
    </div>

</body>

</html>